!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.chordbox=e():r.chordbox=e()}(global,(()=>(()=>{"use strict";var r={d:(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},o:(r,e)=>Object.prototype.hasOwnProperty.call(r,e)},e={};r.d(e,{default:()=>x});const t=require("@svgdotjs/svg.js");function o(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.push.apply(t,o)}return t}function n(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?o(Object(t),!0).forEach((function(e){a(r,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))}))}return r}function i(r,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}function a(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var s=(0,require("svgdom").createSVGWindow)(),d=s.document;(0,t.registerWindow)(s,d);var f={title:"Chord",frets:3,baseFret:1,dots:[],dotText:function(){return""},tunings:["E","A","D","G","B","E"],guages:[46,36,25,17,13,10]},c=285,h=350,u=50,l=50,p=50,g=10;const x={ChordBox:function(){function r(e){return function(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),a(this,"chordBoxOptions",f),this.renderer=(0,t.SVG)(),this.chordBoxOptions=n(n({},this.chordBoxOptions),e),this.validateChordBoxOptions(),this}var e,o;return e=r,(o=[{key:"validateChordBoxOptions",value:function(){if(this.chordBoxOptions.frets<1||this.chordBoxOptions.frets>6)throw new Error("frets must be between 1 and 6");if(this.chordBoxOptions.baseFret<1||this.chordBoxOptions.baseFret>24)throw new Error("baseFret must be between 1 and 24");if(6!==this.chordBoxOptions.tunings.length)throw new Error("tuning must present for 6 strings only");if(6!==this.chordBoxOptions.guages.length)throw new Error("guages must present for 6 strings only")}},{key:"generateChordBoxBase",value:function(){var r=(0,t.SVG)().group(),e=(0,t.SVG)().rect(c,h).radius(5).fill("#000"),o=(0,t.SVG)().rect(275,340).fill("#fff");return r.add(e),r.add(o),e.back(),o.front(),o.move(5,5),r}},{key:"generateChordBoxTitle",value:function(){var r=(0,t.SVG)().group(),e=(0,t.SVG)().rect(275,u).fill("#000"),o=(0,t.SVG)().plain(this.chordBoxOptions.title).attr({"font-size":24,"font-family":"Arial"}).fill("#fff").cx(137.5).cy(25);return r.add(e),r.add(o),e.back(),o.front(),r.move(5,5),r}},{key:"generatechordBoxFretLabels",value:function(){var r=this,e=(0,t.SVG)().group(),o=240/this.chordBoxOptions.frets,n=(0,t.SVG)().rect(l,240).fill("#fff"),i=Array.from(Array(this.chordBoxOptions.frets)).map((function(e,n){var i=(0,t.SVG)().group(),a=(0,t.SVG)().rect(l,o).fill("#fff"),s=(0,t.SVG)().plain((r.chordBoxOptions.baseFret+n).toString()).attr({"font-size":16,"font-family":"Arial"}).fill("#000").cx(25).cy(o/2);return i.add(a),i.add(s),a.back(),s.front(),i.move(0,n*o),i}));return e.add(n),i.map((function(r){e.add(r)})),n.back(),e.move(5,105),e}},{key:"generatechordBoxStringLabels",value:function(){var r=this,e=(0,t.SVG)().group(),o=225/this.chordBoxOptions.tunings.length,n=(0,t.SVG)().rect(225,p).fill("#fff"),i=Array.from(Array(this.chordBoxOptions.tunings.length)).map((function(e,n){var i=(0,t.SVG)().group(),a=(0,t.SVG)().rect(o,p).fill("#fff"),s=(0,t.SVG)().plain(r.chordBoxOptions.tunings[n]).attr({"font-size":16,"font-family":"Arial"}).fill("#000").cx(o/2).cy(25);return i.add(a),i.add(s),a.back(),s.front(),i.move(n*o,0),i}));return e.add(n),i.map((function(r){e.add(r)})),n.back(),e.move(55,55),e}},{key:"generateChordboxBody",value:function(){var r=(0,t.SVG)().group(),e=(0,t.SVG)().rect(225,240).fill("#fff");return r.add(e),r.move(55,105),r}},{key:"generatechordBoxNut",value:function(){var r=(0,t.SVG)().group(),e=(0,t.SVG)().rect(195,g).fill("none").radius(3);return 1===this.chordBoxOptions.baseFret&&e.fill("#000"),r.add(e),r.move(70,105),r}},{key:"generatechordBoxFrets",value:function(){var r=(0,t.SVG)().group(),e=230/this.chordBoxOptions.frets,o=(0,t.SVG)().rect(195,230).fill("#fff"),n=Array.from(Array(this.chordBoxOptions.frets)).map((function(r,o){var n=(0,t.SVG)().rect(195,3).fill("#C0C0C0");return n.move(0,o*e),n}));return r.add(o),n.map((function(e){r.add(e)})),r.back(),r.move(70,115),r}},{key:"generateChordBoxStrings",value:function(){var r=this,e=(0,t.SVG)().group(),o=225/this.chordBoxOptions.tunings.length,n=(0,t.SVG)().rect(225,230).fill("none"),i=Array.from(Array(this.chordBoxOptions.tunings.length)).map((function(e,n){var i=.125*r.chordBoxOptions.guages[n],a=(0,t.SVG)().rect(i,230).fill("#E48C5D");return a.move(n*o+o/2,0),a}));return e.add(n),i.map((function(r){e.add(r)})),e.back(),e.move(55,115),e}},{key:"generateChordBoxDots",value:function(){var r=this,e=(0,t.SVG)().group(),o=225/this.chordBoxOptions.tunings.length,n=230/this.chordBoxOptions.frets,i=this.chordBoxOptions.tunings.length,a=this.chordBoxOptions.guages,s=this.chordBoxOptions.dots,d=(0,t.SVG)().rect(225,230).fill("none"),f=Array.from(s).map((function(e){var s=(0,t.SVG)().group(),d=(0,t.SVG)().circle(30).fill("#000");d.cx((i-e.string)*o+o/2+.125*a[i-e.string]/2).cy((e.fret-1)*n+n/2),1===e.fret&&d.cy(n/2+g/(2*r.chordBoxOptions.frets));var f=(0,t.SVG)().plain(r.chordBoxOptions.dotText(e)).attr({"font-size":12,"font-family":"Arial"}).fill("#fff");return f.cx((i-e.string)*o+o/2+.125*a[i-e.string]/2).cy((e.fret-1)*n+n/2),1===e.fret&&f.cy(n/2+g/(2*r.chordBoxOptions.frets)),s.add(d),s.add(f),d.back(),f.front(),s}));return e.add(d),f.map((function(r){e.add(r)})),e.back(),e.move(55,115),e}},{key:"setDots",value:function(r){return this.chordBoxOptions.dots=r,this.render(),this}},{key:"render",value:function(){return this.renderer.clear(),this.renderer.add(this.generateChordBoxBase()),this.renderer.add(this.generateChordBoxTitle()),this.renderer.add(this.generatechordBoxFretLabels()),this.renderer.add(this.generatechordBoxStringLabels()),this.renderer.add(this.generateChordboxBody()),this.renderer.add(this.generatechordBoxNut()),this.renderer.add(this.generatechordBoxFrets()),this.renderer.add(this.generateChordBoxStrings()),this.renderer.add(this.generateChordBoxDots()),this.renderer.attr({width:c,height:h}),this}},{key:"toSVG",value:function(){return this.renderer.svg()}},{key:"toSVGBase64URI",value:function(){return"data:image/svg+xml;base64,".concat(Buffer.from(this.renderer.svg()).toString("base64"))}}])&&i(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),r}()};return e.default})()));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ckYsS0FBS0MsU0FBU1ksSUFBSWIsS0FBS3NGLHdCQUd2QnRGLEtBQUtDLFNBQ0ZvQixLQUFLLENBQ0prRSxNQUFPMUYsRUFDUDJGLE9BQVEzRixJQUdMRyxJQUNSLEcsbUJBRUQsV0FDRSxPQUFPQSxLQUFLQyxTQUFTd0YsS0FDdEIsRyw0QkFFRCxXQUNFLE1BQU8sNkJBQVAsT0FBb0NDLE9BQU83RCxLQUFLN0IsS0FBS0MsU0FBU3dGLE9BQU9yRCxTQUFTLFVBQy9FLE0sc0VBL2VHdEMsSSIsInNvdXJjZXMiOlsid2VicGFjazovL2Nob3JkYm94L3dlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIndlYnBhY2s6Ly9jaG9yZGJveC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9jaG9yZGJveC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vY2hvcmRib3gvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9jaG9yZGJveC9leHRlcm5hbCBjb21tb25qcyBcIkBzdmdkb3Rqcy9zdmcuanNcIiIsIndlYnBhY2s6Ly9jaG9yZGJveC8uL3NyYy9jaG9yZGJveC50c3giLCJ3ZWJwYWNrOi8vY2hvcmRib3gvZXh0ZXJuYWwgY29tbW9uanMgXCJzdmdkb21cIiJdLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJjaG9yZGJveFwiXSA9IGZhY3RvcnkoKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJjaG9yZGJveFwiXSA9IGZhY3RvcnkoKTtcbn0pKGdsb2JhbCwgKCkgPT4ge1xucmV0dXJuICIsIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJAc3ZnZG90anMvc3ZnLmpzXCIpOyIsImltcG9ydCB7IFNWRywgcmVnaXN0ZXJXaW5kb3cgfSBmcm9tIFwiQHN2Z2RvdGpzL3N2Zy5qc1wiXG5pbXBvcnQgeyBjcmVhdGVTVkdXaW5kb3cgfSBmcm9tIFwic3ZnZG9tXCJcblxuLyogZXNsaW50LWRpc2FibGUgKi9cbmNvbnN0IHdpbmRvdyA9IGNyZWF0ZVNWR1dpbmRvdygpXG5jb25zdCBkb2N1bWVudCA9IHdpbmRvdy5kb2N1bWVudFxucmVnaXN0ZXJXaW5kb3cod2luZG93LCBkb2N1bWVudClcbi8qIGVzbGludC1lbmFibGUgKi9cblxuaW1wb3J0IHtcbiAgQ2hvcmRCb3hSZW5kZXJlcixcbiAgQ2hvcmRCb3hPcHRpb25zLFxuICBDaG9yZEJveERvdFxufSBmcm9tICcuL3R5cGVzJ1xuXG4vLyB0aGUgdGhpbmdzIGEgdXNlciBjYW4gY29uZmlndXJlXG5jb25zdCBDaG9yZEJveE9wdGlvbnNEZWZhdWx0cyA9IHtcbiAgdGl0bGU6ICdDaG9yZCcsXG4gIGZyZXRzOiAzLFxuICBiYXNlRnJldDogMSxcbiAgZG90czogW10gYXMgQ2hvcmRCb3hEb3RbXSxcbiAgZG90VGV4dDogKCkgPT4gJycsXG4gIHR1bmluZ3M6IFsnRScsICdBJywgJ0QnLCAnRycsICdCJywgJ0UnXSxcbiAgZ3VhZ2VzOiBbNDYsIDM2LCAyNSwgMTcsIDEzLCAxMF0sXG59XG5cbmNvbnN0IENIT1JEQk9YX0RJTUVOU0lPTlMgPSB7XG4gIC8vIGJhc2VcbiAgd2lkdGg6IDI4NSxcbiAgaGVpZ2h0OiAzNTAsXG4gIHBhZGRpbmc6IDUsXG4gIHJhZGl1czogNSxcbiAgYm9yZGVyRmlsbENvbG9yOiAnIzAwMCcsXG4gIGZpbGxDb2xvcjogJyNmZmYnLFxuXG4gIC8vIHRpdGxlXG4gIHRpdGxlV2lkdGg6IDI3NSxcbiAgdGl0bGVIZWlnaHQ6IDUwLFxuICB0aXRsZUZpbGxDb2xvcjogJyMwMDAnLFxuICB0aXRsZUZvbnRTaXplOiAyNCxcbiAgdGl0bGVGb250Q29sb3I6ICcjZmZmJyxcblxuICBmcmV0TGFiZWxzV2lkdGg6IDUwLFxuICBmcmV0TGFiZWxzQ29udGFpbmVyRmlsbENvbG9yOiAnI2ZmZicsXG5cbiAgZnJldExhYmVsQ29udGFpbmVyRmlsbENvbG9yOiAnI2ZmZicsXG4gIGZyZXRMYWJlbEZvbnRTaXplOiAxNixcbiAgZnJldExhYmVsRm9udENvbG9yOiAnIzAwMCcsXG5cbiAgc3RyaW5nTGFiZWxzSGVpZ2h0OiA1MCxcbiAgc3RyaW5nTGFiZWxzQ29udGFpbmVyRmlsbENvbG9yOiAnI2ZmZicsXG5cbiAgc3RyaW5nTGFiZWxDb250YWluZXJGaWxsQ29sb3I6ICcjZmZmJyxcbiAgc3RyaW5nTGFiZWxGb250U2l6ZTogMTYsXG4gIHN0cmluZ0xhYmVsRm9udENvbG9yOiAnIzAwMCcsXG5cbiAgYm9keUZpbGxDb2xvcjogJyNmZmYnLFxuXG4gIG51dENvbnRhaW5lclBhZGRpbmc6IDE1LFxuICBudXRIZWlnaHQ6IDEwLFxuICBudXRSYWRpdXM6IDMsXG4gIG51dEZpbGxDb2xvcjogJyMwMDAnLFxuXG4gIGZyZXRzQ29udGFpbmVyRmlsbENvbG9yOiAnI2ZmZicsXG4gIFxuICBmcmV0TWFya2VySGVpZ2h0OiAzLFxuICBmcmV0TWFya2VyRmlsbENvbG9yOiAnI0MwQzBDMCcsXG5cbiAgc3RyaW5nRmlsbENvbG9yOiAnI0U0OEM1RCcsXG5cbiAgZG90U2l6ZTogMzAsXG4gIGRvdEZvbnRTaXplOiAxMixcbiAgZG90RmlsbENvbG9yOiAnIzAwMCdcbn1cbmNsYXNzIENob3JkQm94IHtcblxuICBwcml2YXRlIHJlbmRlcmVyOiBDaG9yZEJveFJlbmRlcmVyXG5cbiAgcHJpdmF0ZSBjaG9yZEJveE9wdGlvbnM6IENob3JkQm94T3B0aW9ucyA9IENob3JkQm94T3B0aW9uc0RlZmF1bHRzXG5cbiAgY29uc3RydWN0b3IgKGNob3JkQm94T3B0aW9uczogQ2hvcmRCb3hPcHRpb25zKSB7XG4gICAgdGhpcy5yZW5kZXJlciA9IFNWRygpXG5cbiAgICAvLyBhc3NpZ24gb3B0aW9uc1xuICAgIHRoaXMuY2hvcmRCb3hPcHRpb25zID0ge1xuICAgICAgLi4udGhpcy5jaG9yZEJveE9wdGlvbnMsXG4gICAgICAuLi5jaG9yZEJveE9wdGlvbnNcbiAgICB9XG5cbiAgICB0aGlzLnZhbGlkYXRlQ2hvcmRCb3hPcHRpb25zKClcblxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBwcml2YXRlIHZhbGlkYXRlQ2hvcmRCb3hPcHRpb25zICgpIHtcbiAgICBpZiAodGhpcy5jaG9yZEJveE9wdGlvbnMuZnJldHMgPCAxIHx8IHRoaXMuY2hvcmRCb3hPcHRpb25zLmZyZXRzID4gNikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdmcmV0cyBtdXN0IGJlIGJldHdlZW4gMSBhbmQgNicpXG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY2hvcmRCb3hPcHRpb25zLmJhc2VGcmV0IDwgMSB8fCB0aGlzLmNob3JkQm94T3B0aW9ucy5iYXNlRnJldCA+IDI0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2Jhc2VGcmV0IG11c3QgYmUgYmV0d2VlbiAxIGFuZCAyNCcpXG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY2hvcmRCb3hPcHRpb25zLnR1bmluZ3MubGVuZ3RoICE9PSA2KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ3R1bmluZyBtdXN0IHByZXNlbnQgZm9yIDYgc3RyaW5ncyBvbmx5JylcbiAgICB9XG5cbiAgICBpZiAodGhpcy5jaG9yZEJveE9wdGlvbnMuZ3VhZ2VzLmxlbmd0aCAhPT0gNikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdndWFnZXMgbXVzdCBwcmVzZW50IGZvciA2IHN0cmluZ3Mgb25seScpXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNob3JkQm94QmFzZSAoKSB7XG4gICAgY29uc3QgY2hvcmRCb3hCYXNlR3JvdXAgPSBTVkcoKS5ncm91cCgpXG5cbiAgICBjb25zdCBjaG9yZEJveEJhc2VDb250YWluZXIgPSBTVkcoKVxuICAgICAgLnJlY3QoXG4gICAgICAgIENIT1JEQk9YX0RJTUVOU0lPTlMud2lkdGgsXG4gICAgICAgIENIT1JEQk9YX0RJTUVOU0lPTlMuaGVpZ2h0KVxuICAgICAgLnJhZGl1cyhDSE9SREJPWF9ESU1FTlNJT05TLnJhZGl1cylcbiAgICAgIC5maWxsKENIT1JEQk9YX0RJTUVOU0lPTlMuYm9yZGVyRmlsbENvbG9yKVxuXG4gICAgY29uc3QgY2hvcmRCb3hCYXNlID0gIFNWRygpXG4gICAgICAucmVjdChcbiAgICAgICAgQ0hPUkRCT1hfRElNRU5TSU9OUy53aWR0aC0oMipDSE9SREJPWF9ESU1FTlNJT05TLnBhZGRpbmcpLFxuICAgICAgICBDSE9SREJPWF9ESU1FTlNJT05TLmhlaWdodC0oMipDSE9SREJPWF9ESU1FTlNJT05TLnBhZGRpbmcpKVxuICAgICAgLmZpbGwoQ0hPUkRCT1hfRElNRU5TSU9OUy5maWxsQ29sb3IpXG5cbiAgICBjaG9yZEJveEJhc2VHcm91cC5hZGQoY2hvcmRCb3hCYXNlQ29udGFpbmVyKVxuICAgIGNob3JkQm94QmFzZUdyb3VwLmFkZChjaG9yZEJveEJhc2UpXG5cbiAgICBjaG9yZEJveEJhc2VDb250YWluZXIuYmFjaygpXG4gICAgY2hvcmRCb3hCYXNlLmZyb250KClcblxuICAgIGNob3JkQm94QmFzZS5tb3ZlKFxuICAgICAgQ0hPUkRCT1hfRElNRU5TSU9OUy5wYWRkaW5nLFxuICAgICAgQ0hPUkRCT1hfRElNRU5TSU9OUy5wYWRkaW5nXG4gICAgKVxuXG4gICAgcmV0dXJuIGNob3JkQm94QmFzZUdyb3VwXG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlQ2hvcmRCb3hUaXRsZSAoKSB7XG4gICAgY29uc3QgY2hvcmRCb3hUaXRsZUdyb3VwID0gU1ZHKCkuZ3JvdXAoKVxuXG4gICAgY29uc3QgY2hvcmRCb3hUaXRsZUNvbnRhaW5lciA9IFNWRygpXG4gICAgICAucmVjdChcbiAgICAgICAgQ0hPUkRCT1hfRElNRU5TSU9OUy50aXRsZVdpZHRoLFxuICAgICAgICBDSE9SREJPWF9ESU1FTlNJT05TLnRpdGxlSGVpZ2h0XG4gICAgICApXG4gICAgICAuZmlsbChDSE9SREJPWF9ESU1FTlNJT05TLnRpdGxlRmlsbENvbG9yKVxuXG4gICAgY29uc3QgQ2hvcmRCb3hUaXRsZSA9IFNWRygpXG4gICAgICAucGxhaW4odGhpcy5jaG9yZEJveE9wdGlvbnMudGl0bGUpXG4gICAgICAuYXR0cih7XG4gICAgICAgICdmb250LXNpemUnOiBDSE9SREJPWF9ESU1FTlNJT05TLnRpdGxlRm9udFNpemUsXG4gICAgICAgICdmb250LWZhbWlseSc6ICdBcmlhbCdcbiAgICAgIH0pXG4gICAgICAuZmlsbChDSE9SREJPWF9ESU1FTlNJT05TLnRpdGxlRm9udENvbG9yKVxuICAgICAgLmN4KENIT1JEQk9YX0RJTUVOU0lPTlMudGl0bGVXaWR0aC8yKVxuICAgICAgLmN5KENIT1JEQk9YX0RJTUVOU0lPTlMudGl0bGVIZWlnaHQvMilcblxuICAgIGNob3JkQm94VGl0bGVHcm91cC5hZGQoY2hvcmRCb3hUaXRsZUNvbnRhaW5lcilcbiAgICBjaG9yZEJveFRpdGxlR3JvdXAuYWRkKENob3JkQm94VGl0bGUpXG5cbiAgICBjaG9yZEJveFRpdGxlQ29udGFpbmVyLmJhY2soKVxuICAgIENob3JkQm94VGl0bGUuZnJvbnQoKVxuXG4gICAgY2hvcmRCb3hUaXRsZUdyb3VwLm1vdmUoXG4gICAgICBDSE9SREJPWF9ESU1FTlNJT05TLnBhZGRpbmcsXG4gICAgICBDSE9SREJPWF9ESU1FTlNJT05TLnBhZGRpbmdcbiAgICApXG5cbiAgICByZXR1cm4gY2hvcmRCb3hUaXRsZUdyb3VwXG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlY2hvcmRCb3hGcmV0TGFiZWxzICgpIHtcbiAgICBjb25zdCBjaG9yZEJveEZyZXRMYWJlbHNHcm91cCA9IFNWRygpLmdyb3VwKClcblxuICAgIGNvbnN0IGZyZXRMYWJlbHNIZWlnaHQgPSBDSE9SREJPWF9ESU1FTlNJT05TLmhlaWdodC0oMipDSE9SREJPWF9ESU1FTlNJT05TLnBhZGRpbmcpLUNIT1JEQk9YX0RJTUVOU0lPTlMudGl0bGVIZWlnaHQtQ0hPUkRCT1hfRElNRU5TSU9OUy5zdHJpbmdMYWJlbHNIZWlnaHRcbiAgICBjb25zdCBmcmV0TGFiZWxIZWlnaHQgPSBmcmV0TGFiZWxzSGVpZ2h0L3RoaXMuY2hvcmRCb3hPcHRpb25zLmZyZXRzXG5cbiAgICBjb25zdCBjaG9yZEJveEZyZXRMYWJlbHNDb250YWluZXIgPSBTVkcoKVxuICAgICAgLnJlY3QoXG4gICAgICAgIENIT1JEQk9YX0RJTUVOU0lPTlMuZnJldExhYmVsc1dpZHRoLFxuICAgICAgICBmcmV0TGFiZWxzSGVpZ2h0XG4gICAgICApXG4gICAgICAuZmlsbChDSE9SREJPWF9ESU1FTlNJT05TLmZyZXRMYWJlbHNDb250YWluZXJGaWxsQ29sb3IpXG4gICAgXG4gICAgY29uc3QgY2hvcmRCb3hGcmV0Ym9hcmRMYWJlbHMgPSBBcnJheVxuICAgICAgLmZyb20oQXJyYXkodGhpcy5jaG9yZEJveE9wdGlvbnMuZnJldHMpKVxuICAgICAgLm1hcCgoXywgZnJldExhYmVsSW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgY2hvcmRCb3hGcmV0TGFiZWxHcm91cD0gU1ZHKCkuZ3JvdXAoKVxuXG4gICAgICAgIGNvbnN0IGNob3JkQm94RnJldExhYmVsQ29udGFpbmVyID0gU1ZHKClcbiAgICAgICAgICAucmVjdChcbiAgICAgICAgICAgIENIT1JEQk9YX0RJTUVOU0lPTlMuZnJldExhYmVsc1dpZHRoLFxuICAgICAgICAgICAgZnJldExhYmVsSGVpZ2h0XG4gICAgICAgICAgKVxuICAgICAgICAgIC5maWxsKENIT1JEQk9YX0RJTUVOU0lPTlMuZnJldExhYmVsQ29udGFpbmVyRmlsbENvbG9yKVxuXG4gICAgICAgIGNvbnN0IGNob3JkQm94RnJldExhYmVsVGV4dCA9IFNWRygpXG4gICAgICAgICAgLnBsYWluKCh0aGlzLmNob3JkQm94T3B0aW9ucy5iYXNlRnJldCArIGZyZXRMYWJlbEluZGV4KS50b1N0cmluZygpKVxuICAgICAgICAgIC5hdHRyKHtcbiAgICAgICAgICAgICdmb250LXNpemUnOiBDSE9SREJPWF9ESU1FTlNJT05TLmZyZXRMYWJlbEZvbnRTaXplLFxuICAgICAgICAgICAgJ2ZvbnQtZmFtaWx5JzogJ0FyaWFsJ1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmZpbGwoQ0hPUkRCT1hfRElNRU5TSU9OUy5mcmV0TGFiZWxGb250Q29sb3IpXG4gICAgICAgICAgLmN4KENIT1JEQk9YX0RJTUVOU0lPTlMuZnJldExhYmVsc1dpZHRoLzIpXG4gICAgICAgICAgLmN5KGZyZXRMYWJlbEhlaWdodC8yKVxuXG4gICAgICAgIGNob3JkQm94RnJldExhYmVsR3JvdXAuYWRkKGNob3JkQm94RnJldExhYmVsQ29udGFpbmVyKVxuICAgICAgICBjaG9yZEJveEZyZXRMYWJlbEdyb3VwLmFkZChjaG9yZEJveEZyZXRMYWJlbFRleHQpXG5cbiAgICAgICAgY2hvcmRCb3hGcmV0TGFiZWxDb250YWluZXIuYmFjaygpXG4gICAgICAgIGNob3JkQm94RnJldExhYmVsVGV4dC5mcm9udCgpXG5cbiAgICAgICAgY2hvcmRCb3hGcmV0TGFiZWxHcm91cC5tb3ZlKFxuICAgICAgICAgIDAsXG4gICAgICAgICAgZnJldExhYmVsSW5kZXgqZnJldExhYmVsSGVpZ2h0XG4gICAgICAgIClcblxuICAgICAgICByZXR1cm4gY2hvcmRCb3hGcmV0TGFiZWxHcm91cFxuICAgICAgfSlcblxuICAgIGNob3JkQm94RnJldExhYmVsc0dyb3VwLmFkZChjaG9yZEJveEZyZXRMYWJlbHNDb250YWluZXIpXG5cbiAgICBjaG9yZEJveEZyZXRib2FyZExhYmVsc1xuICAgICAgLm1hcChjaG9yZEJveEZyZXRMYWJlbCA9PiB7XG4gICAgICAgIGNob3JkQm94RnJldExhYmVsc0dyb3VwLmFkZChjaG9yZEJveEZyZXRMYWJlbClcbiAgICAgIH0pXG5cbiAgICBjaG9yZEJveEZyZXRMYWJlbHNDb250YWluZXIuYmFjaygpXG5cbiAgICBjaG9yZEJveEZyZXRMYWJlbHNHcm91cC5tb3ZlKFxuICAgICAgQ0hPUkRCT1hfRElNRU5TSU9OUy5wYWRkaW5nLFxuICAgICAgQ0hPUkRCT1hfRElNRU5TSU9OUy5wYWRkaW5nICsgQ0hPUkRCT1hfRElNRU5TSU9OUy50aXRsZUhlaWdodCArIENIT1JEQk9YX0RJTUVOU0lPTlMuc3RyaW5nTGFiZWxzSGVpZ2h0XG4gICAgKVxuXG4gICAgcmV0dXJuIGNob3JkQm94RnJldExhYmVsc0dyb3VwXG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlY2hvcmRCb3hTdHJpbmdMYWJlbHMgKCkge1xuICAgIGNvbnN0IGNob3JkQm94U3RyaW5nTGFiZWxzR3JvdXAgPSBTVkcoKS5ncm91cCgpXG5cbiAgICBjb25zdCBzdHJpbmdMYWJlbHNXaWR0aCA9IENIT1JEQk9YX0RJTUVOU0lPTlMud2lkdGgtKDIqQ0hPUkRCT1hfRElNRU5TSU9OUy5wYWRkaW5nKS1DSE9SREJPWF9ESU1FTlNJT05TLmZyZXRMYWJlbHNXaWR0aFxuICAgIGNvbnN0IHN0cmluZ0xhYmVsV2lkdGggPSBzdHJpbmdMYWJlbHNXaWR0aC90aGlzLmNob3JkQm94T3B0aW9ucy50dW5pbmdzLmxlbmd0aCAvLyBzdHJpbmcgY291bnRcblxuICAgIGNvbnN0IGNob3JkQm94U3RyaW5nTGFiZWxzQ29udGFpbmVyID0gU1ZHKClcbiAgICAgIC5yZWN0KFxuICAgICAgICBzdHJpbmdMYWJlbHNXaWR0aCxcbiAgICAgICAgQ0hPUkRCT1hfRElNRU5TSU9OUy5zdHJpbmdMYWJlbHNIZWlnaHRcbiAgICAgIClcbiAgICAgIC5maWxsKENIT1JEQk9YX0RJTUVOU0lPTlMuc3RyaW5nTGFiZWxzQ29udGFpbmVyRmlsbENvbG9yKVxuICAgIFxuICAgIGNvbnN0IGNob3JkQm94U3RyaW5nYm9hcmRMYWJlbHMgPSBBcnJheVxuICAgICAgLmZyb20oQXJyYXkodGhpcy5jaG9yZEJveE9wdGlvbnMudHVuaW5ncy5sZW5ndGggLyogc3RyaW5nIGNvdW50ICovKSlcbiAgICAgIC5tYXAoKF8sIHN0cmluZ0xhYmVsSW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgY2hvcmRCb3hTdHJpbmdMYWJlbEdyb3VwPSBTVkcoKS5ncm91cCgpXG5cbiAgICAgICAgY29uc3QgY2hvcmRCb3hTdHJpbmdMYWJlbENvbnRhaW5lciA9IFNWRygpXG4gICAgICAgICAgLnJlY3QoXG4gICAgICAgICAgICBzdHJpbmdMYWJlbFdpZHRoLFxuICAgICAgICAgICAgQ0hPUkRCT1hfRElNRU5TSU9OUy5zdHJpbmdMYWJlbHNIZWlnaHRcbiAgICAgICAgICApXG4gICAgICAgICAgLmZpbGwoQ0hPUkRCT1hfRElNRU5TSU9OUy5zdHJpbmdMYWJlbENvbnRhaW5lckZpbGxDb2xvcilcblxuICAgICAgICBjb25zdCBjaG9yZEJveFN0cmluZ0xhYmVsVGV4dCA9IFNWRygpXG4gICAgICAgICAgLnBsYWluKHRoaXMuY2hvcmRCb3hPcHRpb25zLnR1bmluZ3Nbc3RyaW5nTGFiZWxJbmRleF0pXG4gICAgICAgICAgLmF0dHIoe1xuICAgICAgICAgICAgJ2ZvbnQtc2l6ZSc6IENIT1JEQk9YX0RJTUVOU0lPTlMuc3RyaW5nTGFiZWxGb250U2l6ZSxcbiAgICAgICAgICAgICdmb250LWZhbWlseSc6ICdBcmlhbCdcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5maWxsKENIT1JEQk9YX0RJTUVOU0lPTlMuc3RyaW5nTGFiZWxGb250Q29sb3IpXG4gICAgICAgICAgLmN4KHN0cmluZ0xhYmVsV2lkdGgvMilcbiAgICAgICAgICAuY3koQ0hPUkRCT1hfRElNRU5TSU9OUy5zdHJpbmdMYWJlbHNIZWlnaHQvMilcblxuICAgICAgICBjaG9yZEJveFN0cmluZ0xhYmVsR3JvdXAuYWRkKGNob3JkQm94U3RyaW5nTGFiZWxDb250YWluZXIpXG4gICAgICAgIGNob3JkQm94U3RyaW5nTGFiZWxHcm91cC5hZGQoY2hvcmRCb3hTdHJpbmdMYWJlbFRleHQpXG5cbiAgICAgICAgY2hvcmRCb3hTdHJpbmdMYWJlbENvbnRhaW5lci5iYWNrKClcbiAgICAgICAgY2hvcmRCb3hTdHJpbmdMYWJlbFRleHQuZnJvbnQoKVxuXG4gICAgICAgIGNob3JkQm94U3RyaW5nTGFiZWxHcm91cC5tb3ZlKFxuICAgICAgICAgIHN0cmluZ0xhYmVsSW5kZXgqc3RyaW5nTGFiZWxXaWR0aCxcbiAgICAgICAgICAwLFxuICAgICAgICApXG5cbiAgICAgICAgcmV0dXJuIGNob3JkQm94U3RyaW5nTGFiZWxHcm91cFxuICAgICAgfSlcblxuICAgIGNob3JkQm94U3RyaW5nTGFiZWxzR3JvdXAuYWRkKGNob3JkQm94U3RyaW5nTGFiZWxzQ29udGFpbmVyKVxuXG4gICAgY2hvcmRCb3hTdHJpbmdib2FyZExhYmVsc1xuICAgICAgLm1hcChjaG9yZEJveFN0cmluZ0xhYmVsID0+IHtcbiAgICAgICAgY2hvcmRCb3hTdHJpbmdMYWJlbHNHcm91cC5hZGQoY2hvcmRCb3hTdHJpbmdMYWJlbClcbiAgICAgIH0pXG5cbiAgICBjaG9yZEJveFN0cmluZ0xhYmVsc0NvbnRhaW5lci5iYWNrKClcblxuICAgIGNob3JkQm94U3RyaW5nTGFiZWxzR3JvdXAubW92ZShcbiAgICAgIENIT1JEQk9YX0RJTUVOU0lPTlMucGFkZGluZyArIENIT1JEQk9YX0RJTUVOU0lPTlMuZnJldExhYmVsc1dpZHRoLFxuICAgICAgQ0hPUkRCT1hfRElNRU5TSU9OUy5wYWRkaW5nICsgQ0hPUkRCT1hfRElNRU5TSU9OUy50aXRsZUhlaWdodCxcbiAgICApXG5cbiAgICByZXR1cm4gY2hvcmRCb3hTdHJpbmdMYWJlbHNHcm91cFxuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNob3JkYm94Qm9keSAoKSB7XG4gICAgY29uc3QgY2hvcmRCb3hCb2R5R3JvdXAgPSBTVkcoKS5ncm91cCgpXG5cbiAgICBjb25zdCBjaG9yZEJveEJvZHkgPSBTVkcoKVxuICAgICAgLnJlY3QoXG4gICAgICAgIENIT1JEQk9YX0RJTUVOU0lPTlMud2lkdGgtKDIqQ0hPUkRCT1hfRElNRU5TSU9OUy5wYWRkaW5nKS1DSE9SREJPWF9ESU1FTlNJT05TLmZyZXRMYWJlbHNXaWR0aCxcbiAgICAgICAgQ0hPUkRCT1hfRElNRU5TSU9OUy5oZWlnaHQtKDIqQ0hPUkRCT1hfRElNRU5TSU9OUy5wYWRkaW5nKS1DSE9SREJPWF9ESU1FTlNJT05TLnRpdGxlSGVpZ2h0LUNIT1JEQk9YX0RJTUVOU0lPTlMuc3RyaW5nTGFiZWxzSGVpZ2h0XG4gICAgICApXG4gICAgICAuZmlsbChDSE9SREJPWF9ESU1FTlNJT05TLmJvZHlGaWxsQ29sb3IpXG5cbiAgICBjaG9yZEJveEJvZHlHcm91cC5hZGQoY2hvcmRCb3hCb2R5KVxuXG4gICAgY2hvcmRCb3hCb2R5R3JvdXAubW92ZShcbiAgICAgIENIT1JEQk9YX0RJTUVOU0lPTlMucGFkZGluZytDSE9SREJPWF9ESU1FTlNJT05TLmZyZXRMYWJlbHNXaWR0aCxcbiAgICAgIENIT1JEQk9YX0RJTUVOU0lPTlMucGFkZGluZytDSE9SREJPWF9ESU1FTlNJT05TLnRpdGxlSGVpZ2h0K0NIT1JEQk9YX0RJTUVOU0lPTlMuc3RyaW5nTGFiZWxzSGVpZ2h0XG4gICAgKVxuXG4gICAgcmV0dXJuIGNob3JkQm94Qm9keUdyb3VwXG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlY2hvcmRCb3hOdXQgKCkge1xuICAgIGNvbnN0IGNob3JkQm94TnV0R3JvdXAgPSBTVkcoKS5ncm91cCgpXG5cbiAgICBjb25zdCBjaG9yZEJveE51dENvbnRhaW5lciA9IFNWRygpXG4gICAgICAucmVjdChcbiAgICAgICAgKENIT1JEQk9YX0RJTUVOU0lPTlMud2lkdGgtKDIqQ0hPUkRCT1hfRElNRU5TSU9OUy5wYWRkaW5nKS1DSE9SREJPWF9ESU1FTlNJT05TLmZyZXRMYWJlbHNXaWR0aCktKDIqQ0hPUkRCT1hfRElNRU5TSU9OUy5udXRDb250YWluZXJQYWRkaW5nKSxcbiAgICAgICAgQ0hPUkRCT1hfRElNRU5TSU9OUy5udXRIZWlnaHRcbiAgICAgIClcbiAgICAgIC5maWxsKCdub25lJykgLy8gaGlkZSBieSBkZWZhdWx0XG4gICAgICAucmFkaXVzKENIT1JEQk9YX0RJTUVOU0lPTlMubnV0UmFkaXVzKVxuICAgIFxuICAgIC8vIHRoZSBudXQgc2hvdWxkIG9ubHkgYmUgdmlzaWJsZSBpZiBiYXNlRnJldCA9PT0gMVxuICAgIGlmICh0aGlzLmNob3JkQm94T3B0aW9ucy5iYXNlRnJldCA9PT0gMSkge1xuICAgICAgY2hvcmRCb3hOdXRDb250YWluZXIuZmlsbChDSE9SREJPWF9ESU1FTlNJT05TLm51dEZpbGxDb2xvcilcbiAgICB9XG5cbiAgICBjaG9yZEJveE51dEdyb3VwLmFkZChjaG9yZEJveE51dENvbnRhaW5lcilcblxuICAgIGNob3JkQm94TnV0R3JvdXAubW92ZShcbiAgICAgIENIT1JEQk9YX0RJTUVOU0lPTlMucGFkZGluZytDSE9SREJPWF9ESU1FTlNJT05TLmZyZXRMYWJlbHNXaWR0aCtDSE9SREJPWF9ESU1FTlNJT05TLm51dENvbnRhaW5lclBhZGRpbmcsXG4gICAgICBDSE9SREJPWF9ESU1FTlNJT05TLnBhZGRpbmcrQ0hPUkRCT1hfRElNRU5TSU9OUy50aXRsZUhlaWdodCtDSE9SREJPWF9ESU1FTlNJT05TLnN0cmluZ0xhYmVsc0hlaWdodFxuICAgIClcblxuICAgIHJldHVybiBjaG9yZEJveE51dEdyb3VwXG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlY2hvcmRCb3hGcmV0cyAoKSB7XG4gICAgY29uc3QgY2hvcmRCb3hGcmV0c0dyb3VwID0gU1ZHKCkuZ3JvdXAoKVxuXG4gICAgY29uc3QgZnJldHNXaWR0aCA9IChDSE9SREJPWF9ESU1FTlNJT05TLndpZHRoLSgyKkNIT1JEQk9YX0RJTUVOU0lPTlMucGFkZGluZyktQ0hPUkRCT1hfRElNRU5TSU9OUy5mcmV0TGFiZWxzV2lkdGgpLSgyKkNIT1JEQk9YX0RJTUVOU0lPTlMubnV0Q29udGFpbmVyUGFkZGluZylcbiAgICBjb25zdCBmcmV0c0hlaWdodCA9IENIT1JEQk9YX0RJTUVOU0lPTlMuaGVpZ2h0LSgyKkNIT1JEQk9YX0RJTUVOU0lPTlMucGFkZGluZyktQ0hPUkRCT1hfRElNRU5TSU9OUy50aXRsZUhlaWdodC1DSE9SREJPWF9ESU1FTlNJT05TLnN0cmluZ0xhYmVsc0hlaWdodC1DSE9SREJPWF9ESU1FTlNJT05TLm51dEhlaWdodFxuICAgIGNvbnN0IGZyZXRIZWlnaHQgPSBmcmV0c0hlaWdodC90aGlzLmNob3JkQm94T3B0aW9ucy5mcmV0c1xuXG4gICAgY29uc3QgY2hvcmRCb3hGcmV0c0NvbnRhaW5lciA9IFNWRygpXG4gICAgICAucmVjdChcbiAgICAgICAgZnJldHNXaWR0aCxcbiAgICAgICAgZnJldHNIZWlnaHRcbiAgICAgICkuZmlsbChDSE9SREJPWF9ESU1FTlNJT05TLmZyZXRzQ29udGFpbmVyRmlsbENvbG9yKVxuXG4gICAgY29uc3QgY2hvcmRCb3hGcmV0TWFya2VycyA9IEFycmF5XG4gICAgICAuZnJvbShBcnJheSh0aGlzLmNob3JkQm94T3B0aW9ucy5mcmV0cykpXG4gICAgICAubWFwKChfLCBmcmV0TWFya2VySW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgZnJldE1hcmtlciA9IFNWRygpXG4gICAgICAgICAgLnJlY3QoXG4gICAgICAgICAgICBmcmV0c1dpZHRoLFxuICAgICAgICAgICAgQ0hPUkRCT1hfRElNRU5TSU9OUy5mcmV0TWFya2VySGVpZ2h0XG4gICAgICAgICAgKVxuICAgICAgICAgIC5maWxsKENIT1JEQk9YX0RJTUVOU0lPTlMuZnJldE1hcmtlckZpbGxDb2xvcilcblxuICAgICAgICBmcmV0TWFya2VyLm1vdmUoXG4gICAgICAgICAgMCxcbiAgICAgICAgICBmcmV0TWFya2VySW5kZXgqZnJldEhlaWdodCxcbiAgICAgICAgKVxuXG4gICAgICAgIHJldHVybiBmcmV0TWFya2VyXG4gICAgICB9KVxuXG4gICAgY2hvcmRCb3hGcmV0c0dyb3VwLmFkZChjaG9yZEJveEZyZXRzQ29udGFpbmVyKVxuXG4gICAgY2hvcmRCb3hGcmV0TWFya2Vycy5tYXAoZnJldE1hcmtlciA9PiB7XG4gICAgICBjaG9yZEJveEZyZXRzR3JvdXAuYWRkKGZyZXRNYXJrZXIpXG4gICAgfSlcblxuICAgIGNob3JkQm94RnJldHNHcm91cC5iYWNrKClcblxuICAgIGNob3JkQm94RnJldHNHcm91cC5tb3ZlKFxuICAgICAgQ0hPUkRCT1hfRElNRU5TSU9OUy5wYWRkaW5nK0NIT1JEQk9YX0RJTUVOU0lPTlMuZnJldExhYmVsc1dpZHRoK0NIT1JEQk9YX0RJTUVOU0lPTlMubnV0Q29udGFpbmVyUGFkZGluZyxcbiAgICAgIENIT1JEQk9YX0RJTUVOU0lPTlMucGFkZGluZytDSE9SREJPWF9ESU1FTlNJT05TLnRpdGxlSGVpZ2h0K0NIT1JEQk9YX0RJTUVOU0lPTlMuc3RyaW5nTGFiZWxzSGVpZ2h0K0NIT1JEQk9YX0RJTUVOU0lPTlMubnV0SGVpZ2h0XG4gICAgKVxuXG4gICAgcmV0dXJuIGNob3JkQm94RnJldHNHcm91cFxuICB9XG4gIFxuICBwcml2YXRlIGdlbmVyYXRlQ2hvcmRCb3hTdHJpbmdzICgpIHtcbiAgICBjb25zdCBjaG9yZEJveFN0cmluZ3NHcm91cCA9IFNWRygpLmdyb3VwKClcblxuICAgIGNvbnN0IHN0cmluZ3NXaWR0aCA9IENIT1JEQk9YX0RJTUVOU0lPTlMud2lkdGgtKDIqQ0hPUkRCT1hfRElNRU5TSU9OUy5wYWRkaW5nKS1DSE9SREJPWF9ESU1FTlNJT05TLmZyZXRMYWJlbHNXaWR0aFxuICAgIGNvbnN0IHN0cmluZ3NIZWlnaHQgPSBDSE9SREJPWF9ESU1FTlNJT05TLmhlaWdodC0oMipDSE9SREJPWF9ESU1FTlNJT05TLnBhZGRpbmcpLUNIT1JEQk9YX0RJTUVOU0lPTlMudGl0bGVIZWlnaHQtQ0hPUkRCT1hfRElNRU5TSU9OUy5zdHJpbmdMYWJlbHNIZWlnaHQtQ0hPUkRCT1hfRElNRU5TSU9OUy5udXRIZWlnaHRcbiAgICBjb25zdCBzdHJpbmdXaWR0aCA9IHN0cmluZ3NXaWR0aC90aGlzLmNob3JkQm94T3B0aW9ucy50dW5pbmdzLmxlbmd0aFxuICAgIGNvbnN0IHN0cmluZ0d1YWdlU2NhbGVGYWN0b3IgPSAwLjEyNVxuXG4gICAgY29uc3QgY2hvcmRCb3hTdHJpbmdzQ29udGFpbmVyID0gU1ZHKClcbiAgICAgIC5yZWN0KFxuICAgICAgICBzdHJpbmdzV2lkdGgsXG4gICAgICAgIHN0cmluZ3NIZWlnaHRcbiAgICAgICkuZmlsbCgnbm9uZScpIC8vIHNvIGZyZXRzIHNob3cgdGhyb3VnaFxuXG4gICAgY29uc3QgY2hvcmRCb3hTdHJpbmdzID0gQXJyYXlcbiAgICAgIC5mcm9tKEFycmF5KHRoaXMuY2hvcmRCb3hPcHRpb25zLnR1bmluZ3MubGVuZ3RoKSlcbiAgICAgIC5tYXAoKF8sIHN0cmluZ0luZGV4KSA9PiB7XG4gICAgICAgIGNvbnN0IHN0cmluZ0d1YWdlID0gdGhpcy5jaG9yZEJveE9wdGlvbnMuZ3VhZ2VzW3N0cmluZ0luZGV4XSAqIHN0cmluZ0d1YWdlU2NhbGVGYWN0b3JcblxuICAgICAgICBjb25zdCBzdHJpbmcgPSBTVkcoKVxuICAgICAgICAgIC5yZWN0KHN0cmluZ0d1YWdlLCBzdHJpbmdzSGVpZ2h0KVxuICAgICAgICAgIC5maWxsKENIT1JEQk9YX0RJTUVOU0lPTlMuc3RyaW5nRmlsbENvbG9yKVxuXG4gICAgICAgIHN0cmluZy5tb3ZlKFxuICAgICAgICAgIHN0cmluZ0luZGV4KnN0cmluZ1dpZHRoICsgc3RyaW5nV2lkdGgvMixcbiAgICAgICAgICAwLFxuICAgICAgICApXG5cbiAgICAgICAgcmV0dXJuIHN0cmluZ1xuICAgICAgfSlcblxuICAgIGNob3JkQm94U3RyaW5nc0dyb3VwLmFkZChjaG9yZEJveFN0cmluZ3NDb250YWluZXIpXG5cbiAgICBjaG9yZEJveFN0cmluZ3MubWFwKHN0cmluZyA9PiB7XG4gICAgICBjaG9yZEJveFN0cmluZ3NHcm91cC5hZGQoc3RyaW5nKVxuICAgIH0pXG5cbiAgICBjaG9yZEJveFN0cmluZ3NHcm91cC5iYWNrKClcblxuICAgIGNob3JkQm94U3RyaW5nc0dyb3VwLm1vdmUoXG4gICAgICBDSE9SREJPWF9ESU1FTlNJT05TLnBhZGRpbmcrQ0hPUkRCT1hfRElNRU5TSU9OUy5mcmV0TGFiZWxzV2lkdGgsXG4gICAgICBDSE9SREJPWF9ESU1FTlNJT05TLnBhZGRpbmcrQ0hPUkRCT1hfRElNRU5TSU9OUy50aXRsZUhlaWdodCtDSE9SREJPWF9ESU1FTlNJT05TLnN0cmluZ0xhYmVsc0hlaWdodCtDSE9SREJPWF9ESU1FTlNJT05TLm51dEhlaWdodFxuICAgIClcblxuICAgIHJldHVybiBjaG9yZEJveFN0cmluZ3NHcm91cFxuICB9XG4gIHByaXZhdGUgZ2VuZXJhdGVDaG9yZEJveERvdHMgKCkge1xuICAgIGNvbnN0IGNob3JkQm94RG90c0dyb3VwID0gU1ZHKCkuZ3JvdXAoKVxuXG4gICAgY29uc3QgZG90c1dpZHRoID0gQ0hPUkRCT1hfRElNRU5TSU9OUy53aWR0aC0oMipDSE9SREJPWF9ESU1FTlNJT05TLnBhZGRpbmcpLUNIT1JEQk9YX0RJTUVOU0lPTlMuZnJldExhYmVsc1dpZHRoXG4gICAgY29uc3QgZG90c0hlaWdodCA9IENIT1JEQk9YX0RJTUVOU0lPTlMuaGVpZ2h0LSgyKkNIT1JEQk9YX0RJTUVOU0lPTlMucGFkZGluZyktQ0hPUkRCT1hfRElNRU5TSU9OUy50aXRsZUhlaWdodC1DSE9SREJPWF9ESU1FTlNJT05TLnN0cmluZ0xhYmVsc0hlaWdodC1DSE9SREJPWF9ESU1FTlNJT05TLm51dEhlaWdodFxuICAgIGNvbnN0IGRvdFdpZHRoID0gZG90c1dpZHRoL3RoaXMuY2hvcmRCb3hPcHRpb25zLnR1bmluZ3MubGVuZ3RoXG4gICAgY29uc3QgZG90SGVpZ2h0ID0gZG90c0hlaWdodC90aGlzLmNob3JkQm94T3B0aW9ucy5mcmV0c1xuXG4gICAgY29uc3Qgc3RyaW5ncyA9IHRoaXMuY2hvcmRCb3hPcHRpb25zLnR1bmluZ3MubGVuZ3RoXG4gICAgY29uc3QgZ3VhZ2VzID0gdGhpcy5jaG9yZEJveE9wdGlvbnMuZ3VhZ2VzXG4gICAgY29uc3Qgc3RyaW5nR3VhZ2VTY2FsZUZhY3RvciA9IDAuMTI1XG5cbiAgICBjb25zdCBvcHRpb25zRG90cyA9IHRoaXMuY2hvcmRCb3hPcHRpb25zLmRvdHNcblxuICAgIGNvbnN0IGNob3JkQm94RG90c0NvbnRhaW5lciA9IFNWRygpXG4gICAgICAucmVjdChcbiAgICAgICAgZG90c1dpZHRoLFxuICAgICAgICBkb3RzSGVpZ2h0XG4gICAgICApLmZpbGwoJ25vbmUnKSAvLyBzbyBkb3RzIHNob3cgdGhyb3VnaFxuXG4gICAgY29uc3QgY2hvcmRCb3hEb3RzID0gQXJyYXlcbiAgICAgIC5mcm9tKG9wdGlvbnNEb3RzKVxuICAgICAgLm1hcChkb3QgPT4ge1xuICAgICAgICBjb25zdCBkb3RHcm91cCA9IFNWRygpLmdyb3VwKClcblxuICAgICAgICBjb25zdCBkb3RDb250YWluZXIgPSBTVkcoKVxuICAgICAgICAgIC5jaXJjbGUoQ0hPUkRCT1hfRElNRU5TSU9OUy5kb3RTaXplKVxuICAgICAgICAgIC5maWxsKENIT1JEQk9YX0RJTUVOU0lPTlMuZG90RmlsbENvbG9yKVxuXG4gICAgICAgIGRvdENvbnRhaW5lclxuICAgICAgICAgIC5jeCgoKHN0cmluZ3MgLSBkb3Quc3RyaW5nKSAqIGRvdFdpZHRoICsgZG90V2lkdGgvMikgKyAoZ3VhZ2VzW3N0cmluZ3MgLSBkb3Quc3RyaW5nXSAqIHN0cmluZ0d1YWdlU2NhbGVGYWN0b3IpIC8gMilcbiAgICAgICAgICAuY3koKGRvdC5mcmV0LTEpICogZG90SGVpZ2h0ICsgZG90SGVpZ2h0LzIpXG5cbiAgICAgICAgLy8gZHVlIHRvIG91ciBjb250YWluZXIgZGltZW5zaW9uc1xuICAgICAgICBpZiAoZG90LmZyZXQgPT09IDEpIHtcbiAgICAgICAgICBkb3RDb250YWluZXIuY3koZG90SGVpZ2h0LzIgKyBDSE9SREJPWF9ESU1FTlNJT05TLm51dEhlaWdodC8oMip0aGlzLmNob3JkQm94T3B0aW9ucy5mcmV0cykpXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBkb3RUZXh0ID0gU1ZHKClcbiAgICAgICAgICAucGxhaW4odGhpcy5jaG9yZEJveE9wdGlvbnMuZG90VGV4dChkb3QpKVxuICAgICAgICAgIC5hdHRyKHtcbiAgICAgICAgICAgICdmb250LXNpemUnOiBDSE9SREJPWF9ESU1FTlNJT05TLmRvdEZvbnRTaXplLFxuICAgICAgICAgICAgJ2ZvbnQtZmFtaWx5JzogJ0FyaWFsJ1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmZpbGwoJyNmZmYnKVxuXG4gICAgICAgIGRvdFRleHRcbiAgICAgICAgICAuY3goKChzdHJpbmdzIC0gZG90LnN0cmluZykgKiBkb3RXaWR0aCArIGRvdFdpZHRoLzIpICsgKGd1YWdlc1tzdHJpbmdzIC0gZG90LnN0cmluZ10gKiBzdHJpbmdHdWFnZVNjYWxlRmFjdG9yKSAvIDIpXG4gICAgICAgICAgLmN5KChkb3QuZnJldC0xKSAqIGRvdEhlaWdodCArIGRvdEhlaWdodC8yKVxuXG4gICAgICAgIC8vIGR1ZSB0byBvdXIgY29udGFpbmVyIGRpbWVuc2lvbnNcbiAgICAgICAgaWYgKGRvdC5mcmV0ID09PSAxKSB7XG4gICAgICAgICAgZG90VGV4dC5jeShkb3RIZWlnaHQvMiArIENIT1JEQk9YX0RJTUVOU0lPTlMubnV0SGVpZ2h0LygyKnRoaXMuY2hvcmRCb3hPcHRpb25zLmZyZXRzKSlcbiAgICAgICAgfVxuXG4gICAgICAgIGRvdEdyb3VwLmFkZChkb3RDb250YWluZXIpXG4gICAgICAgIGRvdEdyb3VwLmFkZChkb3RUZXh0KVxuXG4gICAgICAgIGRvdENvbnRhaW5lci5iYWNrKClcbiAgICAgICAgZG90VGV4dC5mcm9udCgpXG5cbiAgICAgICAgcmV0dXJuIGRvdEdyb3VwXG4gICAgICB9KVxuXG4gICAgY2hvcmRCb3hEb3RzR3JvdXAuYWRkKGNob3JkQm94RG90c0NvbnRhaW5lcilcblxuICAgIGNob3JkQm94RG90cy5tYXAoZG90ID0+IHtcbiAgICAgIGNob3JkQm94RG90c0dyb3VwLmFkZChkb3QpXG4gICAgfSlcblxuICAgIGNob3JkQm94RG90c0dyb3VwLmJhY2soKVxuXG4gICAgY2hvcmRCb3hEb3RzR3JvdXAubW92ZShcbiAgICAgIENIT1JEQk9YX0RJTUVOU0lPTlMucGFkZGluZytDSE9SREJPWF9ESU1FTlNJT05TLmZyZXRMYWJlbHNXaWR0aCxcbiAgICAgIENIT1JEQk9YX0RJTUVOU0lPTlMucGFkZGluZytDSE9SREJPWF9ESU1FTlNJT05TLnRpdGxlSGVpZ2h0K0NIT1JEQk9YX0RJTUVOU0lPTlMuc3RyaW5nTGFiZWxzSGVpZ2h0K0NIT1JEQk9YX0RJTUVOU0lPTlMubnV0SGVpZ2h0XG4gICAgKVxuXG4gICAgcmV0dXJuIGNob3JkQm94RG90c0dyb3VwXG4gIH1cblxuICBwcml2YXRlIHNldERvdHMgKGRvdHM6IENob3JkQm94RG90W10pIHtcbiAgICB0aGlzLmNob3JkQm94T3B0aW9ucy5kb3RzID0gZG90c1xuXG4gICAgdGhpcy5yZW5kZXIoKVxuXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuICBcbiAgcmVuZGVyICgpIHtcbiAgICAvLyBhbHdheXMgY2xlYXIgdGhlIHJlbmRlcmVyXG4gICAgdGhpcy5yZW5kZXJlci5jbGVhcigpXG5cbiAgICAvLyBidWlsZCBpdCB1cCBpbiBsYXllcnNcbiAgICB0aGlzLnJlbmRlcmVyLmFkZCh0aGlzLmdlbmVyYXRlQ2hvcmRCb3hCYXNlKCkpXG4gICAgdGhpcy5yZW5kZXJlci5hZGQodGhpcy5nZW5lcmF0ZUNob3JkQm94VGl0bGUoKSlcblxuICAgIHRoaXMucmVuZGVyZXIuYWRkKHRoaXMuZ2VuZXJhdGVjaG9yZEJveEZyZXRMYWJlbHMoKSlcbiAgICB0aGlzLnJlbmRlcmVyLmFkZCh0aGlzLmdlbmVyYXRlY2hvcmRCb3hTdHJpbmdMYWJlbHMoKSlcblxuICAgIC8vIC8vIGJ1aWxkIHRoZSBib2R5IHBhcnRzXG4gICAgdGhpcy5yZW5kZXJlci5hZGQodGhpcy5nZW5lcmF0ZUNob3JkYm94Qm9keSgpKVxuICAgIHRoaXMucmVuZGVyZXIuYWRkKHRoaXMuZ2VuZXJhdGVjaG9yZEJveE51dCgpKVxuICAgIHRoaXMucmVuZGVyZXIuYWRkKHRoaXMuZ2VuZXJhdGVjaG9yZEJveEZyZXRzKCkpXG4gICAgdGhpcy5yZW5kZXJlci5hZGQodGhpcy5nZW5lcmF0ZUNob3JkQm94U3RyaW5ncygpKVxuICAgIHRoaXMucmVuZGVyZXIuYWRkKHRoaXMuZ2VuZXJhdGVDaG9yZEJveERvdHMoKSlcblxuICAgIC8vIGZpeGVzIGNocm9tZSByZW5kZXJpbmcgaXNzdWVcbiAgICB0aGlzLnJlbmRlcmVyXG4gICAgICAuYXR0cih7XG4gICAgICAgIHdpZHRoOiBDSE9SREJPWF9ESU1FTlNJT05TLndpZHRoLFxuICAgICAgICBoZWlnaHQ6IENIT1JEQk9YX0RJTUVOU0lPTlMuaGVpZ2h0LFxuICAgICAgfSlcblxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICB0b1NWRyAoKSB7XG4gICAgcmV0dXJuIHRoaXMucmVuZGVyZXIuc3ZnKClcbiAgfVxuXG4gIHRvU1ZHQmFzZTY0VVJJICgpIHtcbiAgICByZXR1cm4gYGRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsJHtCdWZmZXIuZnJvbSh0aGlzLnJlbmRlcmVyLnN2ZygpKS50b1N0cmluZyhcImJhc2U2NFwiKX1gXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgeyBDaG9yZEJveCB9IiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJzdmdkb21cIik7Il0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsImdsb2JhbCIsIl9fd2VicGFja19yZXF1aXJlX18iLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJyZXF1aXJlIiwid2luZG93IiwiY3JlYXRlU1ZHV2luZG93IiwiZG9jdW1lbnQiLCJyZWdpc3RlcldpbmRvdyIsIkNob3JkQm94T3B0aW9uc0RlZmF1bHRzIiwidGl0bGUiLCJmcmV0cyIsImJhc2VGcmV0IiwiZG90cyIsImRvdFRleHQiLCJ0dW5pbmdzIiwiZ3VhZ2VzIiwiQ0hPUkRCT1hfRElNRU5TSU9OUyIsIkNob3JkQm94IiwiY2hvcmRCb3hPcHRpb25zIiwidGhpcyIsInJlbmRlcmVyIiwiU1ZHIiwidmFsaWRhdGVDaG9yZEJveE9wdGlvbnMiLCJFcnJvciIsImxlbmd0aCIsImNob3JkQm94QmFzZUdyb3VwIiwiZ3JvdXAiLCJjaG9yZEJveEJhc2VDb250YWluZXIiLCJyZWN0IiwicmFkaXVzIiwiZmlsbCIsImNob3JkQm94QmFzZSIsImFkZCIsImJhY2siLCJmcm9udCIsIm1vdmUiLCJjaG9yZEJveFRpdGxlR3JvdXAiLCJjaG9yZEJveFRpdGxlQ29udGFpbmVyIiwiQ2hvcmRCb3hUaXRsZSIsInBsYWluIiwiYXR0ciIsImN4IiwiY3kiLCJjaG9yZEJveEZyZXRMYWJlbHNHcm91cCIsImZyZXRMYWJlbEhlaWdodCIsImNob3JkQm94RnJldExhYmVsc0NvbnRhaW5lciIsImNob3JkQm94RnJldGJvYXJkTGFiZWxzIiwiQXJyYXkiLCJmcm9tIiwibWFwIiwiXyIsImZyZXRMYWJlbEluZGV4IiwiY2hvcmRCb3hGcmV0TGFiZWxHcm91cCIsImNob3JkQm94RnJldExhYmVsQ29udGFpbmVyIiwiY2hvcmRCb3hGcmV0TGFiZWxUZXh0IiwidG9TdHJpbmciLCJjaG9yZEJveEZyZXRMYWJlbCIsImNob3JkQm94U3RyaW5nTGFiZWxzR3JvdXAiLCJzdHJpbmdMYWJlbFdpZHRoIiwiY2hvcmRCb3hTdHJpbmdMYWJlbHNDb250YWluZXIiLCJjaG9yZEJveFN0cmluZ2JvYXJkTGFiZWxzIiwic3RyaW5nTGFiZWxJbmRleCIsImNob3JkQm94U3RyaW5nTGFiZWxHcm91cCIsImNob3JkQm94U3RyaW5nTGFiZWxDb250YWluZXIiLCJjaG9yZEJveFN0cmluZ0xhYmVsVGV4dCIsImNob3JkQm94U3RyaW5nTGFiZWwiLCJjaG9yZEJveEJvZHlHcm91cCIsImNob3JkQm94Qm9keSIsImNob3JkQm94TnV0R3JvdXAiLCJjaG9yZEJveE51dENvbnRhaW5lciIsImNob3JkQm94RnJldHNHcm91cCIsImZyZXRIZWlnaHQiLCJjaG9yZEJveEZyZXRzQ29udGFpbmVyIiwiY2hvcmRCb3hGcmV0TWFya2VycyIsImZyZXRNYXJrZXJJbmRleCIsImZyZXRNYXJrZXIiLCJjaG9yZEJveFN0cmluZ3NHcm91cCIsInN0cmluZ1dpZHRoIiwiY2hvcmRCb3hTdHJpbmdzQ29udGFpbmVyIiwiY2hvcmRCb3hTdHJpbmdzIiwic3RyaW5nSW5kZXgiLCJzdHJpbmdHdWFnZSIsInN0cmluZyIsImNob3JkQm94RG90c0dyb3VwIiwiZG90V2lkdGgiLCJkb3RIZWlnaHQiLCJzdHJpbmdzIiwib3B0aW9uc0RvdHMiLCJjaG9yZEJveERvdHNDb250YWluZXIiLCJjaG9yZEJveERvdHMiLCJkb3QiLCJkb3RHcm91cCIsImRvdENvbnRhaW5lciIsImNpcmNsZSIsImZyZXQiLCJyZW5kZXIiLCJjbGVhciIsImdlbmVyYXRlQ2hvcmRCb3hCYXNlIiwiZ2VuZXJhdGVDaG9yZEJveFRpdGxlIiwiZ2VuZXJhdGVjaG9yZEJveEZyZXRMYWJlbHMiLCJnZW5lcmF0ZWNob3JkQm94U3RyaW5nTGFiZWxzIiwiZ2VuZXJhdGVDaG9yZGJveEJvZHkiLCJnZW5lcmF0ZWNob3JkQm94TnV0IiwiZ2VuZXJhdGVjaG9yZEJveEZyZXRzIiwiZ2VuZXJhdGVDaG9yZEJveFN0cmluZ3MiLCJnZW5lcmF0ZUNob3JkQm94RG90cyIsIndpZHRoIiwiaGVpZ2h0Iiwic3ZnIiwiQnVmZmVyIl0sInNvdXJjZVJvb3QiOiIifQ==